version: '3.8'

services:
  faq-mcp-server:
    build: .
    container_name: faq-mcp-server
    ports:
      - "9010:9010"
    environment:
      - MONGODB_URI=${MONGODB_URI}
      - DB_NAME=${DB_NAME:-faq_bootcamp}
      - COLLECTION_NAME=${COLLECTION_NAME:-questions}
      - EMBEDDING_PROVIDER=${EMBEDDING_PROVIDER:-local}
      - EMBEDDING_MODEL=${EMBEDDING_MODEL:-BAAI/bge-large-en-v1.5}
      - EMBEDDING_DIMENSION=${EMBEDDING_DIMENSION:-1024}
      - TFIDF_WEIGHT=${TFIDF_WEIGHT:-0.3}
      - EMBEDDING_WEIGHT=${EMBEDDING_WEIGHT:-0.7}
      - SERVER_HOST=${SERVER_HOST:-0.0.0.0}
      - SERVER_PORT=${SERVER_PORT:-9010}
    restart: unless-stopped
    networks:
      - mcp-network

  admin-mcp-server:
    build:
      context: .
      dockerfile: Dockerfile.admin
    image: vicharanashala/faq_vsakha_admin:latest
    container_name: admin-mcp-server
    ports:
      - "9011:9011"
    environment:
      - MONGODB_URI=${MONGODB_URI}
      - DB_NAME=${DB_NAME:-faq_bootcamp}
      - COLLECTION_NAME=${COLLECTION_NAME:-questions}
      - SERVER_HOST=${SERVER_HOST:-0.0.0.0}
      - ADMIN_SERVER_PORT=${ADMIN_SERVER_PORT:-9011}
      - DEFAULT_ADMIN_USER=Kshitij Pandey
      - ADMIN_PASSWORD=${ADMIN_PASSWORD}
      - M_KEY=${M_KEY}
    restart: unless-stopped
    networks:
      - mcp-network
    volumes:
      - ../ace-client/images/downloads:/app/downloads

networks:
  mcp-network:
    driver: bridge
